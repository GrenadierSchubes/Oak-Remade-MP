add_namespace = lar_news


# End of the Spanish Civil War (Nationalist/Carlist victory)
news_event = {
	id = lar_news.1
	title = {
		text = lar_news.1.t_franco
		trigger = {
			country_exists = SPA
			SPA = { has_completed_focus = SPA_unify_the_nationalist_front }
		}
	}
	title = {
		text = lar_news.1.t_falangist
		trigger = {
			country_exists = SPA
			SPA = { has_completed_focus = SPA_the_phalanx_ascendant }
		}
	}
	title = {
		text = lar_news.1.t_carlists
		trigger = {
			country_exists = SPB
		}
	}
	desc = {
		text = lar_news.1.desc_franco
		trigger = {
			country_exists = SPA
			SPA = { has_completed_focus = SPA_unify_the_nationalist_front }
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}
	}
	desc = {
		text = lar_news.1.desc_franco_unified
		trigger = {
			has_global_flag = SPR_franco_won
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
			has_global_flag = scw_early_end
		}
	}
	desc = {
		text = lar_news.1.desc_franco_uprising
		trigger = {
			country_exists = SPA
			SPA = { has_completed_focus = SPA_unify_the_nationalist_front }
			has_global_flag = SPR_carlist_uprising_flag
		}
	}
	desc = {
		text = lar_news.1.desc_falangist
		trigger = {
			country_exists = SPA
			SPA = { has_completed_focus = SPA_the_phalanx_ascendant }
		}
	}
	desc = {
		text = lar_news.1.desc_carlists
		trigger = {
			country_exists = SPB
		}
	}
	picture = GFX_news_event_033
	
	major = yes
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						tag = SPA
						tag = SPB
					}
				}
				if = {
					limit = {
						has_completed_focus = SPA_supremacy_of_the_communion
						NOT = {
							has_global_flag = SPR_carlist_uprising_flag
						}
					}
					clr_country_flag = SPR_nationalist_spain_flag
					drop_cosmetic_tag = yes
					set_country_flag = SPR_carlist_spain_flag
					set_cosmetic_tag = SPR_carlist_spain
					set_party_name = { ideology = neutrality long_name = SPR_neutrality_party_long name = SPR_neutrality_party }
					if = {
						limit = {
							NOT = { has_completed_focus = SPA_head_the_junta_nacional }
						}
						create_country_leader = {
							name = "Manuel Fal Conde"
							desc = "POLITICS_MANUEL_FAL_CONDE_DESC"
							picture = "GFX_portrait_SPA_manuel_fal_conde"
							expire = "1965.1.1"
							ideology = despotism
							traits = {
								jefe
							}
						}
					}
					every_unit_leader = {
						limit = {
							has_trait = trait_SPA_falangist_loyalties
						}
						retire = yes
						remove_unit_leader_trait = trait_SPA_falangist_loyalties
					}
					every_unit_leader = {
						limit = {
							has_trait = trait_SPA_carlist_loyalties
						}
						remove_unit_leader_trait = trait_SPA_carlist_loyalties
					}
					add_popularity = {
					    ideology = fascism
					    popularity = -0.35
					}
				}
				delete_unit_template_and_units = {
					division_template = "Guarnición Nacionalista"
					disband = yes
				}
				delete_unit_template_and_units = {
					division_template = "División de la Guardia de Asalto"
					disband = yes
				}
				delete_unit_template_and_units = {
					division_template = "Brigada de la Guardia Civil"
					disband = yes
				}
				if = {
					limit = {
						NOT = {
							tag = SPB
						}
					}
					delete_unit_template_and_units = {
						division_template = "Requeté Carlista"
						disband = yes
					}
				}
				if = {
					limit = {
						tag = SPA
					}
					every_state = {
						limit = {
							has_state_flag = SPR_core_of_spain_flag
						}
						remove_core_of = SPB
						remove_core_of = SPC
						remove_core_of = SPD
					}
					118 = {
						add_claim_by = SPA
						remove_claim_by = SPB
						remove_claim_by = SPC
						remove_claim_by = SPD
					}
					if = {
						limit = {
							has_completed_focus = SPA_unify_the_nationalist_front
							NOT = {
								has_completed_focus = SPA_caudillo_of_spain
							}
						}
						complete_national_focus = SPA_caudillo_of_spain
					}
					if = {
						limit = {
							has_completed_focus = SPA_the_phalanx_ascendant
							NOT = {
								has_completed_focus = SPA_suspend_the_constitution
							}
						}
						complete_national_focus = SPA_suspend_the_constitution
					}
					if = {
						limit = {
							has_completed_focus = SPA_the_phalanx_ascendant
							NOT = {
								has_completed_focus = SPA_establish_the_directory
							}
						}
						complete_national_focus = SPA_establish_the_directory
					}
				}
				if = {
					limit = {
						tag = SPB
					}
					every_state = {
						limit = {
							has_state_flag = SPR_core_of_spain_flag
						}
						remove_core_of = SPA
						remove_core_of = SPC
						remove_core_of = SPD
					}
					118 = {
						add_claim_by = SPB
						remove_claim_by = SPA
						remove_claim_by = SPC
						remove_claim_by = SPD
					}
					if = {
						limit = {
							has_completed_focus = SPA_supremacy_of_the_communion
							NOT = {
								has_global_flag = SPR_carlist_uprising_flag
							}
						}
						clr_country_flag = SPR_nationalist_spain_flag
						drop_cosmetic_tag = yes
						set_country_flag = SPR_carlist_spain_flag
						set_cosmetic_tag = SPR_carlist_spain
						set_party_name = { ideology = neutrality long_name = SPR_neutrality_party_long name = SPR_neutrality_party }
						add_popularity = {
						    ideology = fascism
						    popularity = -0.35
						}
						add_stability = -0.1
					}
					if = {
						limit = {
							NOT = {
								has_completed_focus = SPA_head_the_junta_nacional
							}
						}
						complete_national_focus = SPA_head_the_junta_nacional
					}
					if = {
						limit = {
							NOT = {
								has_completed_focus = SPA_unite_the_requetes
							}
						}
						complete_national_focus = SPA_unite_the_requetes
					}
				}
				every_state = {
					limit = {
						has_state_flag = SPR_sided_with_republicans_flag
					}
					remove_core_of = ROOT
					start_resistance = yes
				}
				remove_ideas = SPA_death_before_surrender
				if = {
					limit = {
						is_ai = yes 
					}
					add_ideas = SPA_recovering_from_civil_war_ai
				}	
				if = {
					limit = {
						is_ai = no 
					}
					add_timed_idea = { idea = SPA_recovering_from_civil_war days = 1825 }
				}		
				if = {
					limit = {
						has_idea = SPA_foreign_training_staff
					}
					remove_ideas = SPA_foreign_training_staff
				}
				if = {
					limit = {
						has_idea = SPA_a_methodical_approach
					}
					remove_ideas = SPA_a_methodical_approach
				}
				every_state = {
					limit = {
						OR = {
							state = 41
							state = 165
							state = 166
							state = 167
							state = 168
							state = 169
							state = 170
							state = 171
							state = 172
							state = 173
							state = 174
							state = 175
							state = 176
							state = 788
							state = 789
							state = 790
							state = 791
							state = 792
							state = 793
							state = 794
						}
					}
					remove_province_modifier = {
						static_modifiers = { unplanned_offensive }
						province = {
							all_provinces = yes
						}
					}
				}
			}
		}
	}
	
	option = {
		name = lar_news.1.a
		trigger = {
			country_exists = SPB
			NOT = { tag = SPB }
			NOT = { original_tag = SPR }
			has_government = neutrality
		}
	}
	option = {
		name = lar_news.1.b
		trigger = {
			country_exists = SPB
			NOT = { tag = SPB }
			NOT = { original_tag = SPR }
			NOT = { has_government = neutrality }
		}
	}
	option = {
		name = lar_news.1.c
		trigger = {
			OR = {
				AND = {
					tag = GER
					has_government = fascism
				}
				AND = {
					tag = ITA
					has_government = fascism
				}
			}
			NOT = { original_tag = SPR }
			country_exists = SPA
			NOT = { tag = SPA }
		}
		if = { 
			limit = { has_government = fascism }
			add_stability = 0.05
			add_popularity = {
				ideology = fascism
				popularity = 0.03
			}
		}	
	}
	option = {
		name = news.28.a
		trigger = {
			NOT = {
				AND = {
					tag = GER
					has_government = fascism
				}
				AND = {
					tag = ITA
					has_government = fascism
				}
				tag = SOV
			}
			NOT = { original_tag = SPR }
			country_exists = SPA
			NOT = { tag = SPA }
		}
	}
	option = {
		name = lar_news.1.e
		trigger = {
			tag = SOV
			country_exists = SPA
			NOT = { tag = SPA }
			NOT = { original_tag = SPR }
		}
		SOV = {
			add_stability = -0.02
			add_popularity = {
				ideology = communism
				popularity = -0.03
			}
		}
	}
	option = {
		name = lar_news.1.f
		trigger = {
			OR = {
				tag = SPA
				tag = SPB
			}
		}
		effect_tooltip = {
			delete_unit_template_and_units = {
				division_template = "Guarnición Nacionalista"
				disband = yes
			}
			delete_unit_template_and_units = {
				division_template = "División de la Guardia de Asalto"
				disband = yes
			}
			delete_unit_template_and_units = {
				division_template = "Brigada de la Guardia Civil"
				disband = yes
			}
			if = {
				limit = {
					NOT = {
						tag = SPB
					}
				}
				delete_unit_template_and_units = {
					division_template = "Requeté Carlista"
					disband = yes
				}
			}
			every_state = {
				limit = {
					has_state_flag = SPR_sided_with_republicans_flag
				}
				remove_core_of = ROOT
				start_resistance = yes
			}
			remove_ideas = SPA_death_before_surrender
			if = {
				limit = {
					has_idea = SPA_a_methodical_approach
				}
				remove_ideas = SPA_a_methodical_approach
			}
			if = {
				limit = {
					is_ai = yes 
				}
				add_ideas = SPA_recovering_from_civil_war_ai
				}	
			if = {
				limit = {
					is_ai = no 
				}
				add_timed_idea = { idea = SPA_recovering_from_civil_war days = 1825 }
			}
			if = {
				limit = {
					has_idea = SPA_foreign_training_staff
				}
				remove_ideas = SPA_foreign_training_staff
			}
		}
	}
}

#news event - France - Congress of paris

#news event - France - France abandons eastern allies
news_event = {
	id = lar_news.6
	title = lar_news.6.t
	desc = lar_news.6.desc
	picture = GFX_news_event_067

	major = yes

	is_triggered_only = yes

	option = {
		name = lar_news.6.a
		trigger = {
			OR = {
				tag = CZE
				tag = POL
				tag = ROM
			}
		}
	}
	option = {
		name = lar_news.6.b #France friends
		trigger = {
			is_in_faction_with = FRA
			NOT = {
				tag = FRA
				tag = CZE
				tag = POL
				tag = ROM
			}
		}
	}
	option = {
		name = lar_news.6.c #everyone else
		trigger = {
			NOT = {
				is_in_faction_with = FRA
				tag = FRA
				tag = CZE
				tag = POL
				tag = ROM
				tag = GER
				tag = SOV
			}
		}
	}
	option = {
		name = lar_news.6.d #France
		trigger = {
			tag = FRA
		}
	}
	option = {
		name = lar_news.6.e #Germany
		trigger = {
			OR = {
				tag = GER
				tag = SOV
			}
		}
	}
}
